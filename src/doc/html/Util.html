<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Util</title>
<meta name="description" content="Documentation of Coq module Util" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Util</h1>
<div class="coq">
<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Omega</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.Classes</span>.<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RelationClasses</span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">ForallListT</span> <span class="id">A</span> (<span class="id">T</span> : <span class="id">A</span> -&gt; <span class="kwd">Type</span>) : <span class="id">list</span> <span class="id">A</span> -&gt; <span class="kwd">Type</span> :=<br/>
| <span class="id">ForallListT_nil</span> : <span class="id">ForallListT</span> <span class="id">T</span> []<br/>
| <span class="id">ForallListT_cons</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">l</span>, <span class="id">T</span> <span class="id">x</span> -&gt; <span class="id">ForallListT</span> <span class="id">T</span> <span class="id">l</span> -&gt; <span class="id">ForallListT</span> <span class="id">T</span> (<span class="id">x</span> :: <span class="id">l</span>).<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">pred_minus_S</span> : <span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id">pred</span> <span class="id">m</span> - <span class="id">n</span> = <span class="id">m</span> - <span class="id">S</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">rtc</span> {<span class="id">A</span>} (<span class="id">R</span>:<span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id">rtc_refl</span> : <span class="kwd">forall</span> <span class="id">a</span>, <span class="id">rtc</span> <span class="id">R</span> <span class="id">a</span> <span class="id">a</span><br/>
| <span class="id">rtc_step</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span>, <span class="id">R</span> <span class="id">a</span> <span class="id">b</span> -&gt; <span class="id">rtc</span> <span class="id">R</span> <span class="id">b</span> <span class="id">c</span> -&gt; <span class="id">rtc</span> <span class="id">R</span> <span class="id">a</span> <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Instance</span> <span class="id">rtc_Transitive</span> {<span class="id">A</span>} {<span class="id">R</span>} : <span class="id">Transitive</span> (@<span class="id">rtc</span> <span class="id">A</span> <span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Transitive</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H</span>. <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="id">Arguments</span> <span class="id">rtc</span> [<span class="id">_</span>] <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">R</span> ^*" := (<span class="id">rtc</span> <span class="id">R</span>) (<span class="tactic">at</span> <span class="id">level</span> 1, <span class="id">format</span> "<span class="id">R</span> ^*").<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall_map_impl</span> {<span class="id">A</span> <span class="id">B</span>} : <span class="kwd">forall</span> (<span class="id">P</span>:<span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">Q</span>:<span class="id">B</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id">P</span> <span class="id">a</span> -&gt; <span class="id">Q</span> (<span class="id">f</span> <span class="id">a</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>, <span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">Forall</span> <span class="id">Q</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;<span class="tactic">intros</span> ? ? ? <span class="id">Himpl</span> ? <span class="id">Hforall</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> *. <span class="tactic">intros</span> ? <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">in_map_iff</span> <span class="kwd">in</span> <span class="id">Hin</span> <span class="kwd">as</span> [? [? ?]]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Himpl</span>. <span class="tactic">apply</span> <span class="id">Hforall</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">map2</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>:<span class="kwd">Type</span>} (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>) (<span class="id">la</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">lb</span>:<span class="id">list</span> <span class="id">B</span>) : <span class="id">list</span> <span class="id">C</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">la</span>, <span class="id">lb</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [], <span class="id">_</span> | <span class="id">_</span>, [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span>::<span class="id">la</span>', <span class="id">b</span>::<span class="id">lb</span>' =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> :: <span class="id">map2</span> <span class="id">f</span> <span class="id">la</span>' <span class="id">lb</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall2_impl</span> : <span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">P</span> <span class="id">Q</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l2</span><br/>
&nbsp;&nbsp;(<span class="id">Himpl</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">P</span> <span class="id">a</span> <span class="id">b</span> -&gt; <span class="id">Q</span> <span class="id">a</span> <span class="id">b</span>), <span class="id">Forall2</span> <span class="id">P</span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id">Forall2</span> <span class="id">Q</span> <span class="id">l1</span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</div>
<div class="proofscript" id="proof48">
 <span class="tactic">intros</span>; <span class="tactic">induction</span> <span class="id">H</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall2_impl</span>' : <span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">P</span> <span class="id">Q</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l2</span><br/>
&nbsp;&nbsp;(<span class="id">Himpl</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">In</span> <span class="id">a</span> <span class="id">l1</span> -&gt; <span class="id">P</span> <span class="id">a</span> <span class="id">b</span> -&gt; <span class="id">Q</span> <span class="id">a</span> <span class="id">b</span>), <br/>
&nbsp;&nbsp;<span class="id">Forall2</span> <span class="id">P</span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id">Forall2</span> <span class="id">Q</span> <span class="id">l1</span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">induction</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Himpl</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHForall2</span>. <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">Himpl</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall2_length</span> : <span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l2</span>,<br/>
&nbsp;&nbsp;<span class="id">Forall2</span> <span class="id">P</span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id">length</span> <span class="id">l1</span> = <span class="id">length</span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</div>
<div class="proofscript" id="proof50">
 <span class="tactic">intros</span>; <span class="tactic">induction</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">Forall3</span> (<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>) (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span> -&gt; <span class="kwd">Prop</span>) <br/>
&nbsp;&nbsp;: <span class="id">list</span> <span class="id">A</span> -&gt; <span class="id">list</span> <span class="id">B</span> -&gt; <span class="id">list</span> <span class="id">C</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">Forall3_nil</span> : <span class="id">Forall3</span> <span class="id">R</span> [] [] []<br/>
&nbsp;&nbsp;| <span class="id">Forall3_cons</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">l</span> <span class="id">m</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id">Forall3</span> <span class="id">R</span> <span class="id">l</span> <span class="id">m</span> <span class="id">n</span> -&gt; <span class="id">Forall3</span> <span class="id">R</span> (<span class="id">x</span> :: <span class="id">l</span>) (<span class="id">y</span> :: <span class="id">m</span>) (<span class="id">z</span> :: <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">forall2b</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt;<span class="id">bool</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">m</span>:<span class="id">list</span> <span class="id">B</span>) : <span class="id">bool</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fix</span> <span class="id">loop</span> <span class="id">l</span> <span class="id">m</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span>, <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [], [] =&gt; <span class="id">true</span><br/>
&nbsp;&nbsp;| <span class="id">a</span>::<span class="id">l</span>',<span class="id">b</span>::<span class="id">m</span>' =&gt; <span class="id">andb</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">b</span>) (<span class="id">loop</span> <span class="id">l</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id">false</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span> <span class="kwd">in</span> <span class="id">loop</span> <span class="id">l</span> <span class="id">m</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">Nth</span> {<span class="id">A</span>:<span class="kwd">Type</span>} (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">n</span>:<span class="id">nat</span>) (<span class="id">a</span>:<span class="id">A</span>) : <span class="kwd">Prop</span> := <span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">a</span>.<br/>
<br/>
<span class="id">Arguments</span> <span class="id">Nth</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> /. <br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">not_Nth_nil</span> : <span class="kwd">forall</span> <span class="id">X</span> <span class="id">n</span> (<span class="id">x</span>:<span class="id">X</span>),<br/>
&nbsp;&nbsp;~ <span class="id">Nth</span> [] <span class="id">n</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">discriminate</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">not_Nth_nil</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Nth_nth_default</span> : <span class="kwd">forall</span> <span class="id">X</span> <span class="id">l</span> <span class="id">n</span> (<span class="id">a</span>:<span class="id">X</span>) <span class="id">d</span>,<br/>
&nbsp;&nbsp;<span class="id">Nth</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">nth_default</span> <span class="id">d</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">nth_default</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Nth_map</span> : <span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>) (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">l</span> <span class="id">n</span> <span class="id">a</span> <span class="id">b</span><br/>
&nbsp;&nbsp;(<span class="id">Hnth</span> : <span class="id">Nth</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;(<span class="id">Heq</span> : <span class="id">b</span> = <span class="id">f</span> <span class="id">a</span>),<br/>
&nbsp;&nbsp;<span class="id">Nth</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>) <span class="id">n</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">inversion</span> <span class="id">Hnth</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>. <span class="tactic">inversion</span> <span class="id">Hnth</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hnth</span>; <span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">Forall_dec</span> {<span class="id">A</span>} (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">p_dec</span>:<span class="kwd">forall</span> <span class="id">a</span>, {<span class="id">P</span> <span class="id">a</span>} + {~ <span class="id">P</span> <span class="id">a</span>})<br/>
&nbsp;&nbsp;(<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) : {<span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span>} + {~ <span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span>}.<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> <span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span>::<span class="id">l</span>' =&gt; <span class="kwd">match</span> <span class="id">p_dec</span> <span class="id">a</span>, <span class="id">Forall_dec</span> <span class="id">_</span> <span class="id">P</span> <span class="id">p_dec</span> <span class="id">l</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">left</span> <span class="id">Ha</span> , <span class="id">left</span> <span class="id">Hl</span>' =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">inversion</span> <span class="id">contra</span>; <span class="tactic">subst</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">contra</span>. <span class="tactic">inversion</span> <span class="id">contra</span>; <span class="tactic">subst</span>. <span class="id">contradiction</span>.<br/>
Defined.</div>
<span class="id">Arguments</span> <span class="id">Forall_dec</span> {<span class="id">_</span> <span class="id">_</span>} <span class="id">_</span> <span class="id">_</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall_Nth</span> : <span class="kwd">forall</span> (<span class="id">A</span>:<span class="kwd">Type</span>) <span class="id">l</span> <span class="id">P</span> (<span class="id">a</span>:<span class="id">A</span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Nth</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">P</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>; <span class="tactic">subst</span>. <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>. <span class="tactic">inversion</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id">Nth_Forall2_Nth</span> : <span class="kwd">forall</span> <span class="id">n</span> (<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>) <span class="id">l1</span> <span class="id">l2</span> <span class="id">P</span> (<span class="id">b</span>:<span class="id">B</span>),<br/>
&nbsp;&nbsp;<span class="id">Nth</span> <span class="id">l2</span> <span class="id">n</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Forall2</span> <span class="id">P</span> <span class="id">l1</span> <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">a</span>:<span class="id">A</span>), (<span class="id">Nth</span> <span class="id">l1</span> <span class="id">n</span> <span class="id">a</span>) /\ <span class="id">P</span> <span class="id">a</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l2</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">ecase</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall_map_eq</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">l</span><br/>
&nbsp;&nbsp;(<span class="id">Hall</span> : <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span> = <span class="id">g</span> <span class="id">x</span>) <span class="id">l</span>),<br/>
&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">map</span> <span class="id">g</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">auto</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hall</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>, <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="tactic">replace</span> {<span class="id">A</span>:<span class="kwd">Type</span>} (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">n</span>:<span class="id">nat</span>) (<span class="id">a</span>:<span class="id">A</span>) : <span class="id">list</span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span>, <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">O</span>, <span class="id">_</span>::<span class="id">l</span>' =&gt; <span class="id">a</span>::<span class="id">l</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">S</span> <span class="id">n</span>', <span class="id">a</span>'::<span class="id">l</span>' =&gt; <span class="id">a</span>'::<span class="tactic">replace</span> <span class="id">l</span>' <span class="id">n</span>' <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, [] =&gt; []<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">replace_length</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>),<br/>
&nbsp;&nbsp;<span class="id">length</span> (<span class="tactic">replace</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span>) = <span class="id">length</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Nth_replace</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>), <span class="id">n</span> &lt; <span class="id">length</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Nth</span> (<span class="tactic">replace</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span>) <span class="id">n</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Nth</span>; <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_error_replace</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>) <span class="id">n</span>' (<span class="id">Hn</span> : <span class="id">n</span> &lt; <span class="id">length</span> <span class="id">l</span>),<br/>
&nbsp;&nbsp;<span class="id">nth_error</span> (<span class="tactic">replace</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span>) <span class="id">n</span>' = <span class="kwd">if</span> <span class="id">beq_nat</span> <span class="id">n</span> <span class="id">n</span>' <span class="kwd">then</span> <span class="id">Some</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> (<span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">Hn</span>]); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">destruct</span> <span class="id">n</span>'; <span class="tactic">auto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">replace_over</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>) (<span class="id">Hnlt</span> : ~<span class="id">n</span> &lt; <span class="id">length</span> <span class="id">l</span>),<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span> = <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">auto</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">replicate</span> {<span class="id">A</span>} (<span class="id">a</span>:<span class="id">A</span>) (<span class="id">n</span>:<span class="id">nat</span>) : <span class="id">list</span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">O</span> =&gt; <span class="id">nil</span><br/>
&nbsp;&nbsp;| <span class="id">S</span> <span class="id">n</span>' =&gt; <span class="id">a</span> :: <span class="id">replicate</span> <span class="id">a</span> <span class="id">n</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">replicate_length</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>), <span class="id">length</span> (<span class="id">replicate</span> <span class="id">a</span> <span class="id">n</span>) = <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</div>
<div class="proofscript" id="proof61">
 <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">replicate_Nth</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>) <span class="id">n</span>' (<span class="id">Hlt</span> : <span class="id">n</span>' &lt; <span class="id">n</span>),<br/>
&nbsp;&nbsp;<span class="id">Nth</span> (<span class="id">replicate</span> <span class="id">a</span> <span class="id">n</span>) <span class="id">n</span>' <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; [<span class="tactic">inversion</span> <span class="id">Hlt</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">IHn</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">interval</span> <span class="id">n</span> <span class="id">m</span> := <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">O</span> =&gt; []<br/>
&nbsp;&nbsp;| <span class="id">S</span> <span class="id">j</span> =&gt; <span class="kwd">if</span> <span class="id">le_lt_dec</span> <span class="id">n</span> <span class="id">j</span> <span class="kwd">then</span> <span class="id">interval</span> <span class="id">n</span> <span class="id">j</span> ++ [<span class="id">j</span>] <span class="kwd">else</span> []<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall_app</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">P</span> (<span class="id">l</span> <span class="id">l</span>': <span class="id">list</span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> (<span class="id">l</span> ++ <span class="id">l</span>') &lt;-&gt; <span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span> /\ <span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span> [? ?]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">split</span>; [<span class="tactic">intro</span> <span class="id">H</span> | <span class="tactic">intros</span> [<span class="id">H</span> ?]]; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">IHl</span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> <span class="id">H3</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">interval_lt</span> : <span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span>, <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> &lt; <span class="id">m</span>) (<span class="id">interval</span> <span class="id">n</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> <span class="id">n</span> <span class="id">m</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_app</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Forall_impl</span>; <span class="tactic">eauto</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">interval_ge</span> : <span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span>, <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> &gt;= <span class="id">n</span>) (<span class="id">interval</span> <span class="id">n</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> <span class="id">n</span> <span class="id">m</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_app</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">interval_nil</span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">interval</span> <span class="id">n</span> <span class="id">n</span> = [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">auto</span>; <span class="tactic">unfold</span> <span class="id">interval</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> (<span class="id">S</span> <span class="id">n</span>) <span class="id">n</span>); <span class="tactic">auto</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">interval_alt</span> : <span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span>, <span class="id">interval</span> <span class="id">n</span> <span class="id">m</span> = <br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">lt_dec</span> <span class="id">n</span> <span class="id">m</span> <span class="kwd">then</span> <span class="id">n</span> :: <span class="id">interval</span> (<span class="id">S</span> <span class="id">n</span>) <span class="id">m</span> <span class="kwd">else</span> [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">auto</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">interval</span> <span class="tactic">at</span> 1; <span class="id">fold</span> <span class="id">interval</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> <span class="id">n</span> <span class="id">m</span>); <span class="tactic">destruct</span> (<span class="id">lt_dec</span> <span class="id">n</span> (<span class="id">S</span> <span class="id">m</span>)); <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">lt_dec</span> <span class="id">n</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">interval</span> <span class="tactic">at</span> 2; <span class="id">fold</span> <span class="id">interval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> (<span class="id">S</span> <span class="id">n</span>) <span class="id">m</span>); <span class="tactic">auto</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Lt.le_lt_or_eq_iff</span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> <span class="id">l</span>; [<span class="id">contradiction</span> | <span class="tactic">subst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">interval_nil</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">interval_length</span> : <span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span>, <span class="id">length</span> (<span class="id">interval</span> <span class="id">n</span> <span class="id">m</span>) = <span class="id">m</span> - <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">auto</span>; <span class="tactic">intro</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> <span class="id">n</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">app_length</span>, <span class="id">IHm</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_error_nil</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">n</span>, <span class="id">nth_error</span> ([] : <span class="id">list</span> <span class="id">A</span>) <span class="id">n</span> = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_error_In</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>), <span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">a</span> -&gt; <span class="id">In</span> <span class="id">a</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">eauto</span>.      <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">in_nth_error</span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">x</span> : <span class="id">A</span>) <span class="id">l</span>, <span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n</span>, <span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exists</span> 0; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">H</span>); <span class="tactic">destruct</span> <span class="id">IHl</span> <span class="kwd">as</span> (<span class="id">n</span> &amp; ?); <span class="id">exists</span> (<span class="id">S</span> <span class="id">n</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_error_in</span> : <span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>) <span class="id">n</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;<span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">a</span> -&gt; <span class="id">n</span> &lt; <span class="id">length</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>); <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_error_succeeds</span> : <span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>) <span class="id">n</span>, <span class="id">n</span> &lt; <span class="id">length</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>, <span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">distinct</span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;| <span class="id">a</span> :: <span class="id">rest</span> =&gt; ~<span class="id">In</span> <span class="id">a</span> <span class="id">rest</span> /\ <span class="id">distinct</span> <span class="id">rest</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">distinct_inj</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> (<span class="id">a</span> : <span class="id">A</span>) (<span class="id">Hdistinct</span> : <span class="id">distinct</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hi</span> : <span class="id">Nth</span> <span class="id">l</span> <span class="id">i</span> <span class="id">a</span>) (<span class="id">Hj</span> : <span class="id">Nth</span> <span class="id">l</span> <span class="id">j</span> <span class="id">a</span>), <span class="id">i</span> = <span class="id">j</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id">Nth</span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hi</span>; <span class="tactic">subst</span>; <span class="tactic">destruct</span> <span class="id">j</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">inversion</span> <span class="id">Hj</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hdistinct</span> <span class="kwd">as</span> [<span class="id">Hin</span> ?]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">contradiction</span> <span class="id">Hin</span>; <span class="tactic">eapply</span> <span class="id">nth_error_In</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">contradiction</span> <span class="id">Hin</span>; <span class="tactic">eapply</span> <span class="id">nth_error_In</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">distinct_snoc</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> (<span class="id">a</span> : <span class="id">A</span>) (<span class="id">Hdistinct</span> : <span class="id">distinct</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hin</span> : ~<span class="id">In</span> <span class="id">a</span> <span class="id">l</span>), <span class="id">distinct</span> (<span class="id">l</span> ++ [<span class="id">a</span>]).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hdistinct</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>; <span class="tactic">intro</span> <span class="id">Hin</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_app_iff</span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> <span class="id">Hin</span>' <span class="kwd">as</span> [? | [? | ?]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">interval_distinct</span> : <span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span>, <span class="id">distinct</span> (<span class="id">interval</span> <span class="id">n</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> <span class="id">n</span> <span class="id">m</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">distinct_snoc</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">interval_lt</span> <span class="id">m</span> <span class="id">n</span>); <span class="tactic">intro</span> <span class="id">Hlt</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hin</span>; <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">Hlt</span>; <span class="id">specialize</span> (<span class="id">Hlt</span> <span class="id">_</span> <span class="id">Hin</span>); <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Nth_app1</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>) (<span class="id">Hnth</span> : <span class="id">Nth</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span>) <span class="id">l</span>', <br/>
&nbsp;&nbsp;<span class="id">Nth</span> (<span class="id">l</span> ++ <span class="id">l</span>') <span class="id">n</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">unfold</span> <span class="id">Nth</span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hnth</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Nth_app2</span> : <span class="kwd">forall</span> {<span class="id">A</span>} <span class="id">l</span> <span class="id">n</span> (<span class="id">a</span> : <span class="id">A</span>) (<span class="id">Hnth</span> : <span class="id">Nth</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span>) <span class="id">l</span>',<br/>
&nbsp;&nbsp;<span class="id">Nth</span> (<span class="id">l</span>' ++ <span class="id">l</span>) (<span class="id">n</span> + <span class="id">length</span> <span class="id">l</span>') <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>'; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">plus_n_O</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">plus_n_Sm</span>; <span class="tactic">unfold</span> <span class="id">Nth</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Nth_app</span> : <span class="kwd">forall</span> {<span class="id">A</span>} (<span class="id">l</span> <span class="id">l</span>' : <span class="id">list</span> <span class="id">A</span>) <span class="id">n</span> <span class="id">a</span> (<span class="id">Hnth</span> : <span class="id">Nth</span> (<span class="id">l</span> ++ <span class="id">l</span>') <span class="id">n</span> <span class="id">a</span>),<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">lt_dec</span> <span class="id">n</span> (<span class="id">length</span> <span class="id">l</span>) <span class="kwd">then</span> <span class="id">Nth</span> <span class="id">l</span> <span class="id">n</span> <span class="id">a</span> <span class="kwd">else</span> <span class="id">Nth</span> <span class="id">l</span>' (<span class="id">n</span> - <span class="id">length</span> <span class="id">l</span>) <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">minus_n_O</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hnth</span>); <span class="tactic">destruct</span> (<span class="id">lt_dec</span> <span class="id">n</span> (<span class="id">length</span> <span class="id">l</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">lt_dec</span> (<span class="id">S</span> <span class="id">n</span>) (<span class="id">S</span> (<span class="id">length</span> <span class="id">l</span>))); <span class="tactic">auto</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">interval_Nth</span> : <span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span> (<span class="id">Hlt</span> : <span class="id">i</span> &lt; <span class="id">m</span> - <span class="id">n</span>),<br/>
&nbsp;&nbsp;<span class="id">Nth</span> (<span class="id">interval</span> <span class="id">n</span> <span class="id">m</span>) <span class="id">i</span> (<span class="id">i</span> + <span class="id">n</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">Hlt</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">lt_dec</span> <span class="id">i</span> (<span class="id">m</span> - <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> <span class="id">n</span> <span class="id">m</span>); <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Nth_app1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">le_lt_dec</span> <span class="id">n</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (@<span class="id">Nth_app2</span> <span class="id">_</span> [<span class="id">m</span>] 0); <span class="tactic">unfold</span> <span class="id">Nth</span>; <span class="tactic">simpl</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">eq_refl</span> (<span class="id">interval</span> <span class="id">n</span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">interval_length</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">m</span> - <span class="id">n</span>) <span class="kwd">as</span> <span class="id">Hi</span> <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hi</span>; <span class="tactic">assert</span> (<span class="id">m</span> - <span class="id">n</span> + <span class="id">n</span> = <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hm</span> <span class="tactic">by</span> <span class="tactic">omega</span>; <span class="tactic">rewrite</span> <span class="id">Hm</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id">Forall2_forall</span> : <span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">al</span> <span class="id">bl</span>,<br/>
&nbsp;&nbsp;<span class="id">Forall2</span> <span class="id">P</span> <span class="id">al</span> <span class="id">bl</span> &lt;-&gt; (<span class="id">length</span> <span class="id">al</span> = <span class="id">length</span> <span class="id">bl</span> /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">Nth</span> <span class="id">al</span> <span class="id">i</span> <span class="id">a</span> -&gt; <span class="id">Nth</span> <span class="id">bl</span> <span class="id">i</span> <span class="id">b</span> -&gt; <span class="id">P</span> <span class="id">a</span> <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">al</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">split</span>; [<span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span> | <span class="tactic">intros</span> [<span class="id">H</span> ?]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span> ? ? ? <span class="id">Hnth</span> ?; <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hnth</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">bl</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">bl</span>; <span class="tactic">simpl</span>; [<span class="tactic">split</span>; [<span class="tactic">intro</span> <span class="id">H</span> | <span class="tactic">intros</span> [<span class="id">H</span> ?]]; <span class="tactic">inversion</span> <span class="id">H</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">intro</span> <span class="id">H</span> | <span class="tactic">intros</span> [<span class="id">H</span> ?]]; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">IHal</span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> <span class="id">H5</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span> <span class="id">i</span> <span class="id">a1</span> <span class="id">b1</span> <span class="id">Ha1</span> <span class="id">Hb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Ha1</span>; <span class="tactic">inversion</span> <span class="id">Hb1</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id">H0</span> 0); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">IHal</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> (<span class="id">S</span> <span class="id">i</span>)); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="id">Opaque</span> <span class="id">minus</span>.<br/>
<span class="kwd">Lemma</span> <span class="id">interval_shift</span> : <span class="kwd">forall</span> <span class="id">j</span> <span class="id">i</span> <span class="id">k</span>, <span class="id">k</span> &lt;= <span class="id">i</span> -&gt; <span class="id">interval</span> <span class="id">i</span> <span class="id">j</span> =<br/>
&nbsp;&nbsp;<span class="id">map</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> + <span class="id">k</span>) (<span class="id">interval</span> (<span class="id">i</span> - <span class="id">k</span>) (<span class="id">j</span> - <span class="id">k</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</div>
<div class="proofscript" id="proof82">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">j</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Compare_dec.le_lt_dec</span> <span class="id">i</span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">IHj</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Minus.minus_Sn_m</span>; <span class="tactic">simpl</span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Compare_dec.le_lt_dec</span> (<span class="id">i</span> - <span class="id">k</span>) (<span class="id">j</span> - <span class="id">k</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">map_app</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Nat.sub_add</span>; <span class="tactic">auto</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">Compare_dec.le_lt_dec</span> <span class="id">k</span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id">Minus.minus_Sn_m</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Compare_dec.le_lt_dec</span> (<span class="id">i</span> - <span class="id">k</span>) (<span class="id">j</span> - <span class="id">k</span>)); <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">S</span> <span class="id">j</span> - <span class="id">k</span> = 0) <span class="kwd">as</span> <span class="id">Heq</span> <span class="tactic">by</span> <span class="tactic">omega</span>; <span class="tactic">rewrite</span> <span class="id">Heq</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<span class="id">Transparent</span> <span class="id">minus</span>.<br/>
<br/>
<span class="kwd">Corollary</span> <span class="id">interval_S</span> : <span class="kwd">forall</span> <span class="id">j</span> <span class="id">i</span>, <span class="id">interval</span> (<span class="id">S</span> <span class="id">i</span>) (<span class="id">S</span> <span class="id">j</span>) =<br/>
&nbsp;&nbsp;<span class="id">map</span> <span class="id">S</span> (<span class="id">interval</span> <span class="id">i</span> <span class="id">j</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">interval_shift</span> <span class="kwd">with</span> (<span class="id">k</span> := 1); [<span class="tactic">simpl</span> | <span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Nat.sub_0_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">map_ext</span>; <span class="tactic">intro</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">flat_map_map</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id">list</span> <span class="id">C</span>) (<span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id">flat_map</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">g</span> <span class="id">l</span>) = <span class="id">flat_map</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>)) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</div>
<div class="proofscript" id="proof84">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">auto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">flat_map_ext</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id">list</span> <span class="id">B</span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id">f</span> <span class="id">a</span> = <span class="id">g</span> <span class="id">a</span>) -&gt; <span class="kwd">forall</span> <span class="id">l</span>, <span class="id">flat_map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">flat_map</span> <span class="id">g</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">auto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">interval_in_iff</span> : <span class="kwd">forall</span> <span class="id">i</span> <span class="id">j</span> <span class="id">k</span>, <span class="id">In</span> <span class="id">k</span> (<span class="id">interval</span> <span class="id">i</span> <span class="id">j</span>) &lt;-&gt; <span class="id">i</span> &lt;= <span class="id">k</span> &lt; <span class="id">j</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">induction</span> <span class="id">j</span>; <span class="tactic">simpl</span>; [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Compare_dec.le_lt_dec</span> <span class="id">i</span> <span class="id">j</span>); <span class="tactic">simpl</span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_app_iff</span>, <span class="id">IHj</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">app_nth_error1</span>: <span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">l</span> <span class="id">l</span>' : <span class="id">list</span> <span class="id">A</span>) (<span class="id">n</span> : <span class="id">nat</span>),<br/>
&nbsp;&nbsp;<span class="id">n</span> &lt; <span class="id">length</span> <span class="id">l</span> -&gt; <span class="id">nth_error</span> (<span class="id">l</span> ++ <span class="id">l</span>') <span class="id">n</span> = <span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</div>
<div class="proofscript" id="proof87">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span> <span class="id">eqn</span>:<span class="id">Heqn</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">app_nth_error2</span> : <span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">l</span> <span class="id">l</span>' : <span class="id">list</span> <span class="id">A</span>) (<span class="id">n</span> : <span class="id">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">length</span> <span class="id">l</span> &lt;= <span class="id">n</span> -&gt; <span class="id">nth_error</span> (<span class="id">l</span> ++ <span class="id">l</span>') <span class="id">n</span> = <span class="id">nth_error</span> <span class="id">l</span>' (<span class="id">n</span> - <span class="id">length</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</div>
<div class="proofscript" id="proof88">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span> <span class="id">eqn</span>:<span class="id">Heqn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_error_nth</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">l</span> <span class="id">n</span> (<span class="id">d</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span> &lt; <span class="id">length</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> (<span class="id">nth</span> <span class="id">n</span> <span class="id">l</span> <span class="id">d</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</div>
<div class="proofscript" id="proof89">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> 1. <span class="tactic">simpl</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span> <span class="id">eqn</span>:<span class="id">Heqn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">IHl</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">REMOVE</span>.<br/>
<br/>
<span class="kwd">Variables</span> (<span class="id">A</span>:<span class="kwd">Type</span>) (<span class="id">dec</span>:<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id">A</span>), {<span class="id">x</span> = <span class="id">y</span>} + {<span class="id">x</span> &lt;&gt; <span class="id">y</span>}).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">remove_not_In</span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">x</span> &lt;&gt; <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (<span class="id">remove</span> <span class="id">dec</span> <span class="id">y</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</div>
<div class="proofscript" id="proof90">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">y</span> <span class="id">x</span>). <span class="id">contradict</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="id">left</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">y</span> <span class="id">a</span>); <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id">remove_length_le</span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id">length</span> (<span class="id">remove</span> <span class="id">dec</span> <span class="id">x</span> <span class="id">l</span>) &lt;= <span class="id">length</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</div>
<div class="proofscript" id="proof91">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">x</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">remove_length</span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">length</span> (<span class="id">remove</span> <span class="id">dec</span> <span class="id">x</span> <span class="id">l</span>) &lt; <span class="id">length</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</div>
<div class="proofscript" id="proof92">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">x</span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">_</span> | <span class="id">contra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Peano.lt</span>. <span class="tactic">eapply</span> <span class="id">le_n_S</span>. <span class="tactic">apply</span> <span class="id">remove_length_le</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">contra</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>. <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">x</span> <span class="id">H0</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">subst</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">REMOVE</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">rev_nil_rev</span> : <span class="kwd">forall</span> <span class="id">A</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;[] = <span class="id">rev</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">l</span> = [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</div>
<div class="proofscript" id="proof93">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id">rev</span> <span class="id">l</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_map_inv</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">l</span> <span class="id">b</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id">nth_error</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>) <span class="id">n</span> = <span class="id">Some</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>, <span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">a</span> /\ <span class="id">f</span> <span class="id">a</span> = <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</div>
<div class="proofscript" id="proof94">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="tactic">intuition</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ecase</span> <span class="id">IHl</span> <span class="kwd">as</span> [? [? ?]]; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">trim</span> {<span class="id">A</span>} (<span class="id">lo</span>:<span class="id">list</span> (<span class="id">option</span> <span class="id">A</span>)) : <span class="id">list</span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">lo</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] | <span class="id">None</span>::<span class="id">_</span> =&gt; []<br/>
&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">a</span>::<span class="id">lo</span>' =&gt; <span class="id">a</span>::<span class="id">trim</span> <span class="id">lo</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">nth_f</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">d</span>:<span class="id">B</span>) (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">n</span>:<span class="id">nat</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) : <span class="id">B</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fix</span> <span class="id">loop</span> <span class="id">n</span> <span class="id">l</span> {<span class="kwd">struct</span> <span class="id">l</span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span>, <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, [] =&gt; <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">O</span>, <span class="id">a</span>::<span class="id">l</span>' =&gt; <span class="id">f</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">S</span> <span class="id">n</span>', <span class="id">_</span>::<span class="id">l</span>' =&gt; <span class="id">loop</span> <span class="id">n</span>' <span class="id">l</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">loop</span> <span class="id">n</span> <span class="id">l</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_f_nth_error</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">d</span>:<span class="id">B</span>) (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) <span class="id">l</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id">nth_f</span> <span class="id">d</span> <span class="id">f</span> <span class="id">n</span> <span class="id">l</span> = <span class="kwd">match</span> <span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</div>
<div class="proofscript" id="proof95">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">assoc_f</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>} (<span class="id">a_dec</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>:<span class="id">A</span>, {<span class="id">a</span> = <span class="id">b</span>} + {<span class="id">a</span> &lt;&gt; <span class="id">b</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span>:<span class="id">C</span>) (<span class="id">f</span>:<span class="id">B</span> -&gt; <span class="id">C</span>) (<span class="id">a</span>:<span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> (<span class="id">A</span> * <span class="id">B</span>)) : <span class="id">C</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fix</span> <span class="id">rec</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">a</span>',<span class="id">b</span>)::<span class="id">l</span>' =&gt; <span class="kwd">if</span> <span class="id">a_dec</span> <span class="id">a</span> <span class="id">a</span>' <span class="kwd">then</span> <span class="id">f</span> <span class="id">b</span> <span class="kwd">else</span> <span class="id">rec</span> <span class="id">l</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">rec</span> <span class="id">l</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">assoc</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">a_dec</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>:<span class="id">A</span>, {<span class="id">a</span> = <span class="id">b</span>} + {<span class="id">a</span> &lt;&gt; <span class="id">b</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span>:<span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> (<span class="id">A</span> * <span class="id">B</span>)) : <span class="id">option</span> <span class="id">B</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;| (<span class="id">a</span>',<span class="id">b</span>)::<span class="id">l</span>' =&gt; <span class="kwd">if</span> <span class="id">a_dec</span> <span class="id">a</span> <span class="id">a</span>' <span class="kwd">then</span> <span class="id">Some</span> <span class="id">b</span> <span class="kwd">else</span> <span class="id">assoc</span> <span class="id">a_dec</span> <span class="id">a</span> <span class="id">l</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id">assoc_f__assoc</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">l</span> <span class="id">a_dec</span> <span class="id">d</span> (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">C</span>) (<span class="id">a</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;<span class="id">assoc_f</span> <span class="id">a_dec</span> <span class="id">d</span> <span class="id">f</span> <span class="id">a</span> <span class="id">l</span> =<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">assoc</span> <span class="id">a_dec</span> <span class="id">a</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">d</span><br/>
&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">b</span> =&gt; <span class="id">f</span> <span class="id">b</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</div>
<div class="proofscript" id="proof96">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">destruct</span> (<span class="id">a_dec</span> <span class="id">a0</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">assoc_hd</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">a</span>:<span class="id">A</span>) (<span class="id">b</span>:<span class="id">B</span>) <span class="id">l</span> <span class="id">a_dec</span>,<br/>
&nbsp;&nbsp;<span class="id">assoc</span> <span class="id">a_dec</span> <span class="id">a</span> ((<span class="id">a</span>,<span class="id">b</span>)::<span class="id">l</span>) = <span class="id">Some</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</div>
<div class="proofscript" id="proof97">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span> <span class="id">a</span> <span class="id">b</span> <span class="id">l</span> <span class="id">a_dec</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id">a_dec</span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">contradiction</span> <span class="id">n</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">assoc_tl</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">a</span> <span class="id">c</span>:<span class="id">A</span>) (<span class="id">b</span>:<span class="id">B</span>) <span class="id">l</span> <span class="id">a_dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hneq</span> : <span class="id">a</span> &lt;&gt; <span class="id">c</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assoc</span> <span class="id">a_dec</span> <span class="id">a</span> ((<span class="id">c</span>,<span class="id">b</span>)::<span class="id">l</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assoc</span> <span class="id">a_dec</span> <span class="id">a</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</div>
<div class="proofscript" id="proof98">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">a_dec</span> <span class="id">a</span> <span class="id">c</span>). <span class="id">contradiction</span> <span class="id">Hneq</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">a_dec</span> <span class="id">a</span> <span class="id">c</span>). <span class="id">contradiction</span> <span class="id">Hneq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">assoc_cons_inv</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">a</span> <span class="id">c</span>:<span class="id">A</span>) (<span class="id">b</span> <span class="id">d</span>:<span class="id">B</span>) <span class="id">l</span> <span class="id">a_dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hl</span>: <span class="id">assoc</span> <span class="id">a_dec</span> <span class="id">a</span> ((<span class="id">c</span>,<span class="id">b</span>)::<span class="id">l</span>) = <span class="id">Some</span> <span class="id">d</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> = <span class="id">c</span> /\ <span class="id">b</span> = <span class="id">d</span>) \/ (<span class="id">a</span> &lt;&gt; <span class="id">c</span> /\ <span class="id">assoc</span> <span class="id">a_dec</span> <span class="id">a</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">d</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</div>
<div class="proofscript" id="proof99">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span> <span class="id">a</span> <span class="id">c</span> <span class="id">b</span> <span class="id">d</span> <span class="id">l</span> <span class="id">a_dec</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">a_dec</span> <span class="id">a</span> <span class="id">c</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">inversion</span> <span class="id">Hl</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">assoc_In_snd</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">l</span>:<span class="id">list</span> (<span class="id">A</span> * <span class="id">B</span>)) <span class="id">eq_dec</span> <span class="id">a</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;<span class="id">assoc</span> <span class="id">eq_dec</span> <span class="id">a</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">In</span> <span class="id">b</span> (<span class="id">map</span> (@<span class="id">snd</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</div>
<div class="proofscript" id="proof100">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion_clear</span> <span class="id">H</span>; <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">assoc_In</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">l</span>:<span class="id">list</span> (<span class="id">A</span> * <span class="id">B</span>)) <span class="id">eq_dec</span> <span class="id">a</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;<span class="id">assoc</span> <span class="id">eq_dec</span> <span class="id">a</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">In</span> (<span class="id">a</span>,<span class="id">b</span>) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</div>
<div class="proofscript" id="proof101">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion_clear</span> <span class="id">H</span>; <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">assoc_succeeds</span> : <span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">a_dec</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span> : <span class="id">A</span>, {<span class="id">a</span> = <span class="id">b</span>} + {<span class="id">a</span> &lt;&gt; <span class="id">b</span>})<br/>
&nbsp;&nbsp;<span class="id">a</span> <span class="id">l</span>, <span class="id">In</span> <span class="id">a</span> (<span class="id">map</span> (<span class="id">fst</span>(<span class="id">B</span> := <span class="id">B</span>)) <span class="id">l</span>) -&gt; <span class="id">exists</span> <span class="id">x</span>, <span class="id">assoc</span> <span class="id">a_dec</span> <span class="id">a</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</div>
<div class="proofscript" id="proof102">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">a_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">assoc_map</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">eq_dec</span> (<span class="id">x</span> : <span class="id">A</span>) (<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id">C</span>) <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assoc</span> <span class="id">eq_dec</span> <span class="id">x</span> (<span class="id">map</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; (<span class="id">fst</span> <span class="id">p</span>, <span class="id">f</span> (<span class="id">snd</span> <span class="id">p</span>))) <span class="id">l</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;'<span class="id">v</span> &lt;- <span class="id">assoc</span> <span class="id">eq_dec</span> <span class="id">x</span> <span class="id">l</span>; <span class="id">Some</span> (<span class="id">f</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</div>
<div class="proofscript" id="proof103">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eq_dec</span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">map_nth_error_none</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span>  (<span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) (<span class="id">n</span> : <span class="id">nat</span>),<br/>
&nbsp;&nbsp;<span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">None</span> -&gt; <span class="id">nth_error</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>) <span class="id">n</span> = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</div>
<div class="proofscript" id="proof104">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nth_error_out</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>) (<span class="id">n</span> : <span class="id">nat</span>),<br/>
&nbsp;&nbsp;<span class="id">nth_error</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">None</span> -&gt; <span class="id">length</span> <span class="id">l</span> &lt;= <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</div>
<div class="proofscript" id="proof105">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">map_ext_in</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">l</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id">In</span> <span class="id">a</span> <span class="id">l</span> -&gt; <span class="id">f</span> <span class="id">a</span> = <span class="id">g</span> <span class="id">a</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">map</span> <span class="id">g</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</div>
<div class="proofscript" id="proof106">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id">Heq</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>. <span class="tactic">intros</span> ? <span class="id">Hin</span>. <span class="tactic">apply</span> <span class="id">Heq</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">destruct_Forall_cons</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">Forall</span> <span class="id">_</span> (<span class="id">_</span>::<span class="id">_</span>) |- <span class="id">_</span> =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Extern</span> 2 =&gt; <span class="id">destruct_Forall_cons</span> : <span class="id">inversions</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">snoc</span> {<span class="id">A</span>} (<span class="id">a</span>:<span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) : <span class="id">list</span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;<span class="id">l</span> ++ [<span class="id">a</span>].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">snoc_nonnil</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">l</span> (<span class="id">a</span> : <span class="id">A</span>), <span class="id">snoc</span> <span class="id">a</span> <span class="id">l</span> &lt;&gt; [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</div>
<div class="proofscript" id="proof107">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">snoc</span>; <span class="tactic">repeat</span> <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">app_eq_nil</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>); <span class="tactic">intros</span> (? &amp; <span class="id">X</span>); <span class="tactic">inversion</span> <span class="id">X</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">map_option</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) : <span class="id">option</span> (<span class="id">list</span> <span class="id">B</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fix</span> <span class="id">loop</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id">Some</span> []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span>::<span class="id">l</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">f</span> <span class="id">a</span>, <span class="id">loop</span> <span class="id">l</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">b</span>, <span class="id">Some</span> <span class="id">bl</span> =&gt; <span class="id">Some</span> (<span class="id">b</span>::<span class="id">bl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">loop</span> <span class="id">l</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">map_option_map</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>) (<span class="id">g</span>:<span class="id">C</span> -&gt; <span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map_option</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">g</span> <span class="id">l</span>) = <span class="id">map_option</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>)) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</div>
<div class="proofscript" id="proof108">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">f</span> <span class="id">g</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">f</span> (<span class="id">g</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="tactic">rewrite</span> <span class="id">IHl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">map_option_nth</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>) <span class="id">l</span> <span class="id">l</span>',<br/>
&nbsp;&nbsp;<span class="id">map_option</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">l</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">x</span>', <span class="id">nth_error</span> <span class="id">l</span>' <span class="id">i</span> = <span class="id">Some</span> <span class="id">x</span>' &lt;-&gt; <span class="id">exists</span> <span class="id">x</span>, <span class="id">nth_error</span> <span class="id">l</span> <span class="id">i</span> = <span class="id">Some</span> <span class="id">x</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">x</span> = <span class="id">Some</span> <span class="id">x</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</div>
<div class="proofscript" id="proof109">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">nth_error_nil</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> (? &amp; ? &amp; ?); <span class="tactic">rewrite</span> <span class="id">nth_error_nil</span> <span class="kwd">in</span> *; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>) <span class="id">eqn</span>: <span class="id">Ha</span>; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">map_option</span> <span class="id">f</span> <span class="id">l</span>) <span class="id">eqn</span>: <span class="id">Hl</span>'; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">_</span> <span class="id">eq_refl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intro</span> <span class="id">Hx</span>; <span class="tactic">inversion</span> <span class="id">Hx</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> (? &amp; <span class="id">Hx</span> &amp; ?); <span class="tactic">inversion</span> <span class="id">Hx</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ha</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">map_option_length</span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>) <span class="id">l</span> <span class="id">l</span>',<br/>
&nbsp;&nbsp;<span class="id">map_option</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">l</span>' -&gt; <span class="id">length</span> <span class="id">l</span>' = <span class="id">length</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof110')">Proof.</div>
<div class="proofscript" id="proof110">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">map_option</span> <span class="id">f</span> <span class="id">l</span>) <span class="id">eqn</span>: <span class="id">Hl</span>'; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">map_option_snd</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>} (<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id">option</span> <span class="id">C</span>) (<span class="id">p</span>:<span class="id">A</span> * <span class="id">B</span>) : <span class="id">option</span> (<span class="id">A</span> * <span class="id">C</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">x</span>,<span class="id">y</span>) := <span class="id">p</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;'<span class="id">z</span> &lt;- <span class="id">f</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Some</span> (<span class="id">x</span>,<span class="id">z</span>).<br/>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">find_map</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>) (<span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>) : <span class="id">option</span> <span class="id">B</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;| <span class="id">x</span>::<span class="id">xs</span> =&gt; <span class="kwd">match</span> (<span class="id">f</span> <span class="id">x</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">find_map</span> <span class="id">f</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">ans</span> =&gt; <span class="id">Some</span> <span class="id">ans</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">find_map_cons_none</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Set</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span>: <span class="id">A</span>),<br/>
&nbsp;&nbsp;<span class="id">f</span> <span class="id">a</span> = <span class="id">None</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">find_map</span> <span class="id">f</span> (<span class="id">a</span> :: <span class="id">l</span>) = <span class="id">find_map</span> <span class="id">f</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof111')">Proof.</div>
<div class="proofscript" id="proof111">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">find_map</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">find_map_cons_none</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">find_map_cons_some</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Set</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span>: <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">b</span>: <span class="id">B</span>),<br/>
&nbsp;&nbsp;<span class="id">f</span> <span class="id">a</span> = <span class="id">Some</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">find_map</span> <span class="id">f</span> (<span class="id">a</span> :: <span class="id">l</span>) = <span class="id">f</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof112')">Proof.</div>
<div class="proofscript" id="proof112">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">find_map</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">find_map_cons_some</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">find_map_cons</span>: <span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Set</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span>: <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">b</span>: <span class="id">B</span>),<br/>
&nbsp;&nbsp;<span class="id">find_map</span> <span class="id">f</span> (<span class="id">a</span> :: <span class="id">l</span>) = <span class="id">Some</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">f</span> <span class="id">a</span> = <span class="id">Some</span> <span class="id">b</span> \/<br/>
&nbsp;&nbsp;(<span class="id">f</span> <span class="id">a</span> = <span class="id">None</span> /\ <span class="id">find_map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof113')">Proof.</div>
<div class="proofscript" id="proof113">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">f</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">discriminant</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">discriminant</span>).<br/>
<br/>
&nbsp;&nbsp;- <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EQUIV</span>: <span class="id">find_map</span> <span class="id">f</span> (<span class="id">a</span> :: <span class="id">l</span>) = <span class="id">f</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">find_map_cons_some</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Heqdiscriminant</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqdiscriminant</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">EQUIV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;-  <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">find_map_cons_none</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">find_map_cons</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">agress_on_filter</span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Set</span>} (<span class="id">filter</span>: <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>) (<span class="id">g</span>: <span class="id">A</span> -&gt; <span class="id">A</span>): <span class="kwd">Prop</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">a</span>: <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">b</span>: <span class="id">B</span>), <span class="id">filter</span> <span class="id">a</span> = <span class="id">Some</span> <span class="id">b</span> -&gt; <span class="id">exists</span> <span class="id">b</span>', <span class="id">filter</span> (<span class="id">g</span> <span class="id">a</span>) = <span class="id">Some</span> <span class="id">b</span>') /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">filter</span> <span class="id">a</span> = <span class="id">None</span> -&gt; <span class="id">filter</span> (<span class="id">g</span> <span class="id">a</span>) = <span class="id">None</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">find_map_mapped_some_1</span>: <span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Set</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">g</span>: <span class="id">A</span> -&gt; <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">b</span>: <span class="id">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">agress_on_filter</span> <span class="id">f</span> <span class="id">g</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">a</span>: <span class="id">A</span>), <span class="id">Some</span> <span class="id">b</span> = <span class="id">f</span> <span class="id">a</span> /\ <span class="id">find_map</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">g</span> <span class="id">l</span>) = (<span class="id">f</span> (<span class="id">g</span> <span class="id">a</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof114')">Proof.</div>
<div class="proofscript" id="proof114">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">G_AGRESS_ON_FILTER_F</span> <span class="id">FIND_IN_LIST</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">find_map</span> <span class="kwd">in</span> <span class="id">FIND_IN_LIST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FIND_IN_LIST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">CASES</span>: <span class="id">f</span> <span class="id">a</span> = <span class="id">Some</span> <span class="id">b</span> \/ (<span class="id">f</span> <span class="id">a</span> = <span class="id">None</span> /\ <span class="id">find_map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">find_map_cons</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">CASES</span> <span class="kwd">as</span> [<span class="id">HD</span> | <span class="id">TAIL</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exists</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">MAP_ON_A_CONS_L</span>: <span class="id">map</span> <span class="id">g</span> (<span class="id">a</span> :: <span class="id">l</span>) = <span class="id">g</span> <span class="id">a</span> :: (<span class="id">map</span> <span class="id">g</span> <span class="id">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MAP_ON_A_CONS_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">agress_on_filter</span> <span class="kwd">in</span> <span class="id">G_AGRESS_ON_FILTER_F</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">G_AGRESS_ON_FILTER_F</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">G_AGRESS_ON_FILTER_F</span>) <span class="kwd">as</span> [<span class="id">ON_FILTER</span>  <span class="id">ON_NO_FILTER</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">ON_FILTER</span> <span class="id">b</span> <span class="id">HD</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ON_FILTER</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">find_map_cons_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">TAIL</span> <span class="kwd">as</span> [<span class="id">F_A_NONE</span> <span class="id">FIND_IN_L</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">b</span> <span class="id">G_AGRESS_ON_FILTER_F</span> <span class="id">FIND_IN_L</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHl</span> <span class="kwd">as</span> [<span class="id">AVAL</span> [<span class="id">F_AVAL</span> <span class="id">FIND_IN_L_WITNESS</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">AVAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">find_map</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">g</span> (<span class="id">a</span> :: <span class="id">l</span>)) = <span class="id">find_map</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">g</span> <span class="id">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">find_map_cons_none</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">agress_on_filter</span> <span class="kwd">in</span> <span class="id">G_AGRESS_ON_FILTER_F</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">G_AGRESS_ON_FILTER_F</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Theorem</span> <span class="id">find_map_mapped_none</span>: <span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Set</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">g</span>: <span class="id">A</span> -&gt; <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">agress_on_filter</span> <span class="id">f</span> <span class="id">g</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">None</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_map</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">g</span> <span class="id">l</span>) = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof115')">Proof.</div>
<div class="proofscript" id="proof115">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>  <span class="id">G_AGRESS_ON_FILTER_F</span> <span class="id">FIND_IN_LIST</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">find_map</span> <span class="kwd">in</span> <span class="id">FIND_IN_LIST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">FA_CASES</span>: <span class="id">f</span> <span class="id">a</span> = <span class="id">None</span> \/ <span class="id">exists</span> <span class="id">b</span>, <span class="id">f</span> <span class="id">a</span> = <span class="id">Some</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">FA_CASES</span> <span class="kwd">as</span> [<span class="id">FA_NONE</span> | <span class="id">FA_SOME</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++  <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">f</span> (<span class="id">g</span> <span class="id">a</span>) = <span class="id">None</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">FGA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">FGA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">find_map_cons_none</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">agress_on_filter</span> <span class="kwd">in</span> <span class="id">G_AGRESS_ON_FILTER_F</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">G_AGRESS_ON_FILTER_F</span>; <span class="tactic">auto</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">destruct</span> <span class="id">FA_SOME</span> <span class="kwd">as</span> [<span class="id">b</span> <span class="id">B_WITNESS</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">find_map</span> <span class="kwd">in</span> <span class="id">FIND_IN_LIST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B_WITNESS</span> <span class="kwd">in</span> <span class="id">FIND_IN_LIST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">combine_lists_err</span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">l1</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">l2</span>:<span class="id">list</span> <span class="id">B</span>) : <span class="id">err</span> (<span class="id">list</span> (<span class="id">A</span> * <span class="id">B</span>)) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l1</span>, <span class="id">l2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [], [] =&gt; <span class="id">mret</span> []<br/>
&nbsp;&nbsp;| <span class="id">x</span>::<span class="id">xs</span>, <span class="id">y</span>::<span class="id">ys</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;'<span class="id">l</span> &lt;- <span class="id">combine_lists_err</span> <span class="id">xs</span> <span class="id">ys</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mret</span> ((<span class="id">x</span>,<span class="id">y</span>)::<span class="id">l</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id">failwith</span> "<span class="id">combine_lists_err</span>: <span class="id">different</span> <span class="id">lenth</span> <span class="id">lists</span>"<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
