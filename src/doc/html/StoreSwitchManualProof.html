<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module StoreSwitchManualProof</title>
<meta name="description" content="Documentation of Coq module StoreSwitchManualProof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module StoreSwitchManualProof</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ZArith</span> <span class="id">List</span> <span class="id">String</span> <span class="id">Omega</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.AstLib</span> <span class="id">Vellvm.LLVMAst</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.Classes</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.Util</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.CFG</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.LLVMIO</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.DynamicValues</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.StepSemantics</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span>  <span class="id">Vellvm.Classes</span> <span class="id">Vellvm.Util</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.LLVMAst</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.TypeUtil</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.Memory</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.Trace</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Setoid</span> <span class="id">Morphisms</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coq.Setoids.Setoid</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">SetoidClass</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coq.Classes.RelationClasses</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coq.Classes.Equivalence</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.StoreSwitch</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.TopLevel</span>.<br/>
<span class="kwd">Require</span> <span class="id">FunctionalExtensionality</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Eqdep_dec</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Classical</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Vellvm.Trace</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">FSets.FMapAVL</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Integers</span>.<br/>
<span class="kwd">Require</span> <span class="id">Coq.Structures.OrderedTypeEx</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ZMicromega</span>.<br/>
<span class="kwd">Import</span> <span class="id">IO.DV</span>.<br/>
<span class="kwd">Import</span> <span class="id">Trace.MonadVerif</span>.<br/>
<span class="kwd">Require</span> <span class="id">Nsatz</span>.<br/>
<br/>
<div class="doc">Enable SSReflect for better rewrite *</div>
<span class="id">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="id">ssreflect</span> <span class="id">ssrbool</span> <span class="id">ssrfun</span> <span class="id">bigop</span>.<br/>
<span class="kwd">Import</span> <span class="id">ssreflect.SsrSyntax</span>.<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<span class="kwd">Unset</span> <span class="kwd">Strict</span> <span class="kwd">Implicit</span>.<br/>
<span class="kwd">Unset</span> <span class="id">Printing</span> <span class="kwd">Implicit</span> <span class="id">Defensive</span>.<br/>
<br/>
<br/>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<div class="doc">MEMORY *</div>
<br/>
<br/>
<span class="kwd">Check</span> (<span class="id">M.memD</span>).<br/>
<span class="kwd">Check</span> (<span class="id">M.memD</span> <span class="id">M.empty</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
<div class="doc">PROGRAM *</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">simpleProgramInitBBId</span> : <span class="id">block_id</span> := <span class="id">Name</span> "<span class="id">entry</span>".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">Notation</span> <span class="id">i32ty</span> := (<span class="id">TYPE_I</span> (32%<span class="id">Z</span>)).<br/>
<span class="kwd">Notation</span> <span class="id">i8ty</span> := (<span class="id">TYPE_I</span> (8%<span class="id">Z</span>)).<br/>
<span class="kwd">Notation</span> <span class="id">i32ptrty</span> :=  (<span class="id">TYPE_Pointer</span> <span class="id">i32ty</span>).<br/>
<span class="kwd">Notation</span> <span class="id">i8ptrty</span> :=  (<span class="id">TYPE_Pointer</span> <span class="id">i8ty</span>).<br/>
<span class="kwd">Definition</span> <span class="id">mkI32</span> (<span class="id">i</span>: <span class="id">Z</span>): <span class="id">texp</span> :=<br/>
&nbsp;&nbsp;(<span class="id">i32ty</span>, <span class="id">EXP_Integer</span> <span class="id">i</span>).<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">mkI8</span> (<span class="id">i</span>: <span class="id">Z</span>): <span class="id">texp</span> :=<br/>
&nbsp;&nbsp;(<span class="id">i8ty</span>, <span class="id">EXP_Integer</span> <span class="id">i</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">xty</span> := <span class="id">TYPE_Array</span> 2 <span class="id">i32ty</span>.<br/>
<span class="kwd">Definition</span> <span class="id">xptrty</span> := <span class="id">TYPE_Pointer</span> <span class="id">xty</span>.<br/>
<span class="kwd">Definition</span> <span class="id">mkLLVMInt</span> (<span class="id">i</span>: <span class="id">Z</span>): <span class="id">texp</span> := <span class="id">mkI32</span> <span class="id">i</span>.<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">allocaX</span> : <span class="id">instr_id</span> * <span class="id">instr</span> :=<br/>
&nbsp;&nbsp;(<span class="id">IId</span> (<span class="id">Name</span> "<span class="id">x</span>"),<br/>
&nbsp;&nbsp;&nbsp;<span class="id">INSTR_Alloca</span> (<span class="id">xptrty</span>) (<span class="id">Some</span> (<span class="id">mkLLVMInt</span> 0)) <span class="id">None</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">xexpr</span>: <span class="id">texp</span> := (<span class="id">xptrty</span>, <span class="id">EXP_Ident</span> (<span class="id">ID_Local</span> (<span class="id">Name</span> "<span class="id">x</span>"))).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">mkGEPI32</span> (<span class="id">name</span>: <span class="id">string</span>) (<span class="id">idx</span>: <span class="id">Z</span>) : <span class="id">texp</span> :=<br/>
&nbsp;&nbsp;(<span class="id">xty</span>, <span class="id">OP_GetElementPtr</span> <span class="id">xty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xptrty</span>, <span class="id">EXP_Ident</span> (<span class="id">ID_Local</span> (<span class="id">Name</span> <span class="id">name</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;([<span class="id">mkI32</span> <span class="id">idx</span>])).<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">mkGEPI8</span> (<span class="id">name</span>: <span class="id">string</span>) (<span class="id">idx</span>: <span class="id">Z</span>) : <span class="id">texp</span> :=<br/>
&nbsp;&nbsp;(<span class="id">i8ptrty</span>, <span class="id">OP_GetElementPtr</span> <span class="id">i8ty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i8ptrty</span>, <span class="id">EXP_Ident</span> (<span class="id">ID_Local</span> (<span class="id">Name</span> <span class="id">name</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;([<span class="id">mkI32</span> <span class="id">idx</span>])).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">mkXGEP</span> := <span class="id">mkGEPI32</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">storeXAt0</span>: <span class="id">instr_id</span> * <span class="id">instr</span> :=<br/>
&nbsp;&nbsp;(<span class="id">IVoid</span> 0%<span class="id">Z</span>, <span class="id">INSTR_Store</span> <span class="id">false</span> (<span class="id">mkLLVMInt</span> 1) (<span class="id">mkXGEP</span> "<span class="id">x</span>" 0) <span class="id">None</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">storeXAt1</span>: <span class="id">instr_id</span> * <span class="id">instr</span> :=<br/>
&nbsp;&nbsp;(<span class="id">IVoid</span> 1%<span class="id">Z</span>, <span class="id">INSTR_Store</span> <span class="id">false</span> (<span class="id">mkLLVMInt</span> 2) (<span class="id">mkXGEP</span> "<span class="id">x</span>" 1) <span class="id">None</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">loadXAt0</span>: <span class="id">instr_id</span> * <span class="id">instr</span> :=<br/>
&nbsp;&nbsp;(<span class="id">IId</span> (<span class="id">Name</span> "<span class="id">xat0</span>"), <span class="id">INSTR_Load</span> <span class="id">false</span> <span class="id">i32ty</span> (<span class="id">mkXGEP</span> "<span class="id">x</span>" 0) <span class="id">None</span>).<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Definition</span> <span class="id">pcfg</span> : <span class="id">cfg</span> := <br/>
{|<br/>
&nbsp;&nbsp;<span class="id">init</span> := <span class="id">simpleProgramInitBBId</span>;<br/>
&nbsp;&nbsp;<span class="id">blks</span> := [{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_id</span>     := <span class="id">simpleProgramInitBBId</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_phis</span>  := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_code</span>  := [ <span class="id">allocaX</span>; <span class="id">storeXAt0</span>; <span class="id">storeXAt1</span>; <span class="id">loadXAt0</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_term</span>  := ((<span class="id">IVoid</span> 2%<span class="id">Z</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TERM_Ret</span> (<span class="id">i32ty</span>, (<span class="id">EXP_Ident</span> (<span class="id">ID_Local</span> (<span class="id">Name</span> "<span class="id">xat0</span>")))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}];<br/>
&nbsp;&nbsp;<span class="id">args</span> := [];<br/>
&nbsp;&nbsp;|}.<br/>
<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Definition</span> <span class="id">mainproto</span> : <span class="id">declaration</span> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_name</span>        := <span class="id">Name</span> "<span class="id">main</span>";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_type</span>        :=  <span class="id">TYPE_Function</span> <span class="id">TYPE_Void</span> [<span class="id">TYPE_I</span> 32];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_param_attrs</span> := ([], []);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_linkage</span>     := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_visibility</span>  := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_dll_storage</span> := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_cconv</span>       := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_attrs</span>       := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_section</span>     := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_align</span>       := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dc_gc</span>          := <span class="id">None</span>;<br/>
<br/>
&nbsp;&nbsp;|}.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">pmain</span> : <span class="id">definition</span> <span class="id">cfg</span>  :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_prototype</span>   := <span class="id">mainproto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_args</span>        := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_instrs</span>      := <span class="id">pcfg</span>;<br/>
&nbsp;&nbsp;|}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">program</span> : <span class="id">mcfg</span> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_name</span> := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_target</span> := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_datalayout</span> := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_type_defs</span> := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_globals</span> := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_declarations</span> := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_definitions</span>:= [<span class="id">pmain</span>];<br/>
&nbsp;&nbsp;|}.<br/>
<br/>
<br/>
<div class="doc">Modified program *</div>
<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Definition</span> <span class="id">pcfg</span>' : <span class="id">cfg</span> := <br/>
{|<br/>
&nbsp;&nbsp;<span class="id">init</span> := <span class="id">simpleProgramInitBBId</span>;<br/>
&nbsp;&nbsp;<span class="id">blks</span> := [{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_id</span>     := <span class="id">simpleProgramInitBBId</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_phis</span>  := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_code</span>  := [ <span class="id">allocaX</span>; <span class="id">storeXAt1</span>; <span class="id">storeXAt0</span>; <span class="id">loadXAt0</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_term</span>  := ((<span class="id">IVoid</span> 2%<span class="id">Z</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TERM_Ret</span> (<span class="id">i32ty</span>, (<span class="id">EXP_Ident</span> (<span class="id">ID_Local</span> (<span class="id">Name</span> "<span class="id">xat0</span>")))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}];<br/>
&nbsp;&nbsp;<span class="id">args</span> := [];<br/>
|}.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Definition</span> <span class="id">pmain</span>' : <span class="id">definition</span> <span class="id">cfg</span>  :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_prototype</span>   := <span class="id">mainproto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_args</span>        := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_instrs</span>      := <span class="id">pcfg</span>';<br/>
&nbsp;&nbsp;|}.<br/>
<span class="kwd">Definition</span> <span class="id">program</span>': <span class="id">mcfg</span> := <br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_name</span> := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_target</span> := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_datalayout</span> := <span class="id">None</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_type_defs</span> := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_globals</span> := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_declarations</span> := [];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m_definitions</span>:= [<span class="id">pmain</span>'];<br/>
&nbsp;&nbsp;|}.<br/>
<span class="id">Close</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">program_program</span>'<span class="id">_register_fn_eq</span>:<br/>
&nbsp;&nbsp;<span class="id">TopLevel.SS.register_functions</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TopLevel.SS.ENV.empty</span> <span class="id">IO.DV.dvalue</span>) ≡<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TopLevel.SS.register_functions</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">program</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TopLevel.SS.ENV.empty</span> <span class="id">IO.DV.dvalue</span>) /\<br/>
&nbsp;&nbsp;<span class="id">TopLevel.SS.register_functions</span> <span class="id">program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TopLevel.SS.ENV.empty</span> <span class="id">IO.DV.dvalue</span>) =<br/>
<span class="id">Trace.Tau</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TopLevel.SS.register_declaration</span> (<span class="id">TopLevel.SS.ENV.empty</span> <span class="id">IO.DV.dvalue</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mainproto</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof314')">Proof.</div>
<div class="proofscript" id="proof314">
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">TopLevel.SS.register_functions</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">bindM_Ret</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">TopLevel.SS.register_declaration</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;+  <span class="tactic">rewrite</span> <span class="id">Trace.matchM</span>. <span class="tactic">simpl</span>.  <span class="tactic">auto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">program_program</span>'<span class="id">_build_global_environment_eq</span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id">TopLevel.SS.build_global_environment</span> <span class="id">program</span> ≡<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TopLevel.SS.build_global_environment</span> <span class="id">program</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof315')">Proof.</div>
<div class="proofscript" id="proof315">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">TopLevel.SS.build_global_environment</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">TopLevel.SS.allocate_globals</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id">bindM_Ret</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">program_program</span>'<span class="id">_register_fn_eq</span> <span class="kwd">as</span> [<span class="id">FN_EQ</span> <span class="id">FN_VAL</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">TopLevel.SS.initialize_globals</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">build_global_env_program_value</span>:<br/>
&nbsp;&nbsp;<span class="id">TopLevel.SS.build_global_environment</span> <span class="id">program</span> ≡ <span class="id">Ret</span> (<span class="id">TopLevel.SS.ENV.empty</span> <span class="id">dvalue</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof316')">Proof.</div>
<div class="proofscript" id="proof316">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">TopLevel.SS.build_global_environment</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">TopLevel.SS.allocate_globals</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">bindM_Ret</span>.<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">TopLevel.SS.register_functions</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">bindM</span> (<span class="id">Ret</span> (<span class="id">TopLevel.SS.ENV.empty</span> <span class="id">dvalue</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">y</span> : <span class="id">TopLevel.SS.genv</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TopLevel.SS.register_declaration</span> <span class="id">y</span> <span class="id">mainproto</span>)) ≡<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">TopLevel.SS.register_declaration</span> <span class="id">y</span> <span class="id">mainproto</span>) (<span class="id">TopLevel.SS.ENV.empty</span> <span class="id">dvalue</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">bindM_Ret</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Abort.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">eval_typ_i32</span>: <span class="kwd">forall</span> (<span class="id">CFG</span>:<span class="id">mcfg</span>), <span class="id">SS.eval_typ</span> (<span class="id">CFG</span> )<span class="id">i32ty</span> = <span class="id">DTYPE_I</span> 32.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof317')">Proof.</div>
<div class="proofscript" id="proof317">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.eval_typ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">normalize_type_equation</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">eval_typ_i8</span>: <span class="kwd">forall</span> (<span class="id">CFG</span>: <span class="id">mcfg</span>), <span class="id">SS.eval_typ</span> (<span class="id">CFG</span>) <span class="id">i8ty</span> = <span class="id">DTYPE_I</span> 8.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof318')">Proof.</div>
<div class="proofscript" id="proof318">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.eval_typ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">normalize_type_equation</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">eval_typ_array_i32</span>: <span class="kwd">forall</span> (<span class="id">CFG</span>: <span class="id">mcfg</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SS.eval_typ</span> <span class="id">CFG</span> (<span class="id">TYPE_Array</span> 2 <span class="id">i32ty</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DTYPE_Array</span> 2 (<span class="id">DTYPE_I</span> 32).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof319')">Proof.</div>
<div class="proofscript" id="proof319">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.eval_typ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id">normalize_type_equation</span>; <span class="tactic">simpl</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">eval_typ_i32</span> : <span class="id">euttnormdb</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">eval_typ_i8</span> : <span class="id">euttnormdb</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">eval_typ_array_i32</span> : <span class="id">euttnormdb</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">eval_typ_i32</span> : <span class="id">euttnormdb</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">eval_typ_i8</span> : <span class="id">euttnormdb</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">eval_typ_array_i32</span> : <span class="id">euttnormdb</span>.<br/>
<br/>
<span class="kwd">Hint</span> <span class="id">Transparent</span> <span class="id">SS.init_state</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">SS.init_state</span>.<br/>
<br/>
<br/>
<br/>
<div class="doc">ALL HELL BREAKS LOOSE OTHERWISE *</div>
<span class="id">Opaque</span> <span class="id">M.add_all_index</span>.<br/>
<span class="id">Opaque</span> <span class="id">M.lookup_all_index</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<div class="doc">Show what the original program produces *</div>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<span class="kwd">Theorem</span> <span class="id">original_program_execution</span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id">M.memD</span> <span class="id">M.empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">bindM</span> (<span class="id">TopLevel.SS.init_state</span> <span class="id">program</span> "<span class="id">main</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">s</span> : <span class="id">TopLevel.SS.state</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TopLevel.SS.step_sem</span> <span class="id">program</span> (<span class="id">TopLevel.SS.Step</span> <span class="id">s</span>))) ≡<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Ret</span> (<span class="id">DVALUE_I32</span>  (<span class="id">Int32.repr</span> 1%<span class="id">Z</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof320')">Proof.</div>
<div class="proofscript" id="proof320">
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.init_state</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.build_global_environment</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.allocate_globals</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.register_functions</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.register_declaration</span>.<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Set</span> <span class="kwd">Ltac</span> <span class="id">debug</span>.<br/>
&nbsp;&nbsp;<span class="id">forcetrace</span>.<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.initialize_globals</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (  <span class="id">euttnorm</span> ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M.forcememd</span> ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">SS.forcestepsem</span> ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.cont</span>;<span class="tactic">simpl</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> @<span class="id">Trace.matchM</span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">bindM</span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">tauN_eutt_1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;TODO:&nbsp;Why&nbsp;does&nbsp;the&nbsp;tactic&nbsp;rewrite&nbsp;not&nbsp;work?!&nbsp;WTF&nbsp;*)</span>&nbsp;rewrite&nbsp;force_memD_ret.&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">SS.forcestepsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> @<span class="id">Trace.matchM</span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">M.memD</span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">xty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">Int32.unsigned</span> (<span class="id">Int32.repr</span> 0)) <span class="kwd">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">Int32.unsigned</span> (<span class="id">Int32.repr</span> 1)) <span class="kwd">with</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">M.lookup_all_index_of_add_all_index_no_alias</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">M.lookup_all_index_of_add_all_index_full_alias</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">M.sbyte_list_to_Z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Int.unsigned_repr</span>; <span class="tactic">try</span> <span class="tactic">omega</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Int.max_unsigned</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Int.modulus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Int.unsigned_repr</span>; <span class="tactic">try</span> <span class="tactic">omega</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Int.max_unsigned</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Int.modulus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="id">Close</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">new_program_execution</span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id">M.memD</span> <span class="id">M.empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">bindM</span> (<span class="id">TopLevel.SS.init_state</span> <span class="id">program</span>' "<span class="id">main</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">s</span> : <span class="id">TopLevel.SS.state</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TopLevel.SS.step_sem</span> <span class="id">program</span>' (<span class="id">TopLevel.SS.Step</span> <span class="id">s</span>))) ≡<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Ret</span> (<span class="id">DVALUE_I32</span> (<span class="id">Int32.repr</span> 1%<span class="id">Z</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof321')">Proof.</div>
<div class="proofscript" id="proof321">
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.init_state</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.build_global_environment</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.allocate_globals</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.register_functions</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.register_declaration</span>.<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;<span class="id">forcetrace</span>.<br/>
&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.initialize_globals</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (  <span class="id">euttnorm</span> ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">M.forcememd</span> ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">SS.forcestepsem</span> ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SS.cont</span>;<span class="tactic">simpl</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> @<span class="id">Trace.matchM</span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">bindM</span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">euttnorm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">tauN_eutt_1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;TODO:&nbsp;Why&nbsp;does&nbsp;the&nbsp;tactic&nbsp;rewrite&nbsp;not&nbsp;work?!&nbsp;WTF&nbsp;*)</span>&nbsp;rewrite&nbsp;force_memD_ret.&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">SS.forcestepsem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> @<span class="id">Trace.matchM</span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">M.memD</span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">xty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">Int32.unsigned</span> (<span class="id">Int32.repr</span> 0)) <span class="kwd">with</span> 0; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">Int32.unsigned</span> (<span class="id">Int32.repr</span> 1)) <span class="kwd">with</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">M.lookup_all_index_of_add_all_index_full_alias</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
Qed.</div>
<br/>
<div class="doc">State what we want to prove *</div>
<span class="kwd">Definition</span> <span class="id">program_program</span>'<span class="id">_have_same_semantics</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">run_mcfg_with_memory</span> <span class="id">program</span> ≡ <span class="id">run_mcfg_with_memory</span> <span class="id">program</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof322')">Proof.</div>
<div class="proofscript" id="proof322">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">run_mcfg_with_memory</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">original_program_execution</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">new_program_execution</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
